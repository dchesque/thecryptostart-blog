## Glossary & Domain Concepts

This glossary defines key terminology, domain entities, and concepts central to the CryptoStart Blog project, a Next.js-based blogging platform integrated with Contentful for content management, Prisma for database operations, and NextAuth for authentication. 

**Domain Entities:**
- **BlogPost**: Represents a single blog article, including metadata, content, author, categories, and related posts. Fetched and transformed from Contentful entries.
- **Author**: Metadata for post authors, including name, bio, and avatar.
- **BlogCategory**: Predefined categories for organizing posts (e.g., "Blockchain", "DeFi").
- **User**: Authenticated site visitor or admin, with roles for permissions.
- **Session/JWT**: Authentication state managed via NextAuth, storing user roles and permissions.

**Key Concepts:**
- **Contentful Integration**: Headless CMS providing rich text content, images, and SEO fields for blog posts.
- **Rate Limiting**: Protects API endpoints from abuse using IP-based throttling.
- **Role-Based Access Control (RBAC)**: Permissions checked via roles (e.g., admin) for admin dashboard and user management.
- **SEO Optimization**: Structured data (Schema.org) and metadata generation for search engines.
- **Static Generation**: Uses `generateStaticParams` for blog post slugs to pre-render pages at build time.

**User Personas:**
- **Blog Reader**: Casual visitor seeking crypto education; goals include browsing posts, searching, and reading articles.
- **Registered User**: Authenticated reader; can register/login for personalized features.
- **Site Admin**: Manages users and monitors activity via admin dashboard.

See [project-overview.md](./project-overview.md) for high-level architecture.

## Type Definitions

Exported interfaces and type aliases define the core data shapes. Links point to source locations:

- [`Post`](../types/index.ts) - Base post interface for internal use.
- [`SiteConfig`](../types/index.ts#L33) - Global site configuration (e.g., title, description, social links).
- [`SEOProps`](../types/index.ts#L41) - Props for SEO metadata generation.
- [`FeaturedImage`](../types/blog.ts#L28) - Image metadata with URL, alt text, and dimensions.
- [`Author`](../types/blog.ts#L44) - Author details (name, avatar, bio).
- [`BlogPost`](../types/blog.ts#L61) - Full blog post structure post-transformation from Contentful.
- [`BlogMetadata`](../types/blog.ts#L91) - Post metadata (title, slug, date, excerpt).
- [`PaginationOptions`](../types/blog.ts#L109) - Options for paginated queries (limit, skip).
- [`SearchOptions`](../types/blog.ts#L121) - Search parameters (query, category, tags).
- [`ContentfulBlogPostFields`](../types/blog.ts#L130) - Raw fields from Contentful API response.
- [`ContentfulSys`](../types/blog.ts#L162) - System metadata from Contentful (ID, type, timestamps).
- [`ContentfulBlogPost`](../types/blog.ts#L171) - Complete Contentful entry type.
- [`CategoryConfig`](../types/blog.ts#L179) - Category display config (slug, name, color).
- [`TagOptions`](../types/blog.ts#L188) - Options for post tags.
- [`RolePermissions`](../types/roles.ts#L31) - Maps roles to allowed permissions.
- [`UserWithRoles`](../types/auth.ts#L24) - Extended user type including roles array.
- [`LoginInput`](../lib/validations.ts#L20) - Zod schema for login form validation.
- [`RegisterInput`](../lib/validations.ts#L21) - Zod schema for registration form.
- [`UpdateProfileInput`](../lib/validations.ts#L22) - Zod schema for profile updates.

## Enumerations

No exported enums are defined in the codebase. Categories and roles are handled via `type` aliases or `const` assertions (e.g., `BlogCategory` as a union type in [types/blog.ts](../types/blog.ts#L15)).

## Core Terms

- **BlogPost**: Central domain entity representing an article. Transformed via `transformPost` in [lib/contentful.ts](../lib/contentful.ts#L74). Used in pages like `app/blog/[slug]/page.tsx` and components like `BlogPost.tsx`.
- **ContentfulBlogPost**: Raw API response from Contentful. Fetched by functions like `getPostBySlug` ([lib/contentful.ts](../lib/contentful.ts#L179)). Surfaces in data fetching layers.
- **RolePermissions**: Defines admin capabilities (e.g., "user:manage"). Checked via `hasRole` and `hasPermission` in [lib/permissions.ts](../lib/permissions.ts). Critical for admin routes like `app/admin/users/page.tsx`.
- **RateLimitError**: Custom error thrown by `checkRateLimit` ([lib/rate-limit.ts](../lib/rate-limit.ts#L14)). Prevents API abuse in endpoints like user registration.
- **CSRF Token**: Security token generated by `generateCSRFToken` ([lib/csrf.ts](../lib/csrf.ts#L8)). Validates form submissions to mitigate cross-site request forgery.
- **Reading Time**: Estimated via `calculateReadingTime` ([lib/utils.ts](../lib/utils.ts#L1) or [lib/contentful.ts](../lib/contentful.ts#L51)). Displays on post pages for user convenience.

## Acronyms & Abbreviations

- **CMS**: Content Management System – Contentful provides this for blog content.
- **RBAC**: Role-Based Access Control – Implemented via `RolePermissions` and permission checks.
- **SEO**: Search Engine Optimization – Handled by [lib/seo.ts](../lib/seo.ts) functions like `generateMetadata`.
- **JWT**: JSON Web Token – Used in NextAuth sessions for auth state.
- **API**: Application Programming Interface – Routes in `app/api/` (e.g., `/api/users`, `/api/auth/register`).
- **Prisma**: ORM for database operations, used in auth and user management.

## Personas / Actors

- **Blog Reader**: Goal: Discover and read crypto/blockchain content. Workflow: Browse categories (`getPostsByCategory`), search (`searchPosts`), read posts with TOC, related posts, and share buttons. Pain points addressed: Fast loading via static generation, mobile-friendly UI, reading time estimates.
- **Registered User**: Goal: Personalized access. Workflow: Login/register, manage profile. Pain points: Secure auth with rate limiting and CSRF protection.
- **Site Admin**: Goal: Oversee users and site health. Workflow: Access dashboard (`app/admin/page.tsx`), view users (`fetchUsers` in `app/admin/users/page.tsx`). Requires "admin" role; pain points: Permission checks prevent unauthorized access.

## Domain Rules & Invariants

- **Authentication**: All admin routes require valid session with roles; throws `AuthenticationError` ([lib/errors.ts](../lib/errors.ts#L12)) if missing.
- **Authorization**: Uses `hasRole`/`hasPermission` for granular checks (e.g., user management requires "admin:user").
- **Rate Limiting**: API calls (e.g., register) limited by IP via Upstash Redis; exceeds throw `RateLimitError`.
- **Validation**: Zod schemas (`LoginInput`, etc.) enforce inputs; invalid throws `ValidationError`.
- **Content Fetching**: Posts must have unique slugs; pagination limits prevent overload (default via `PaginationOptions`).
- **CSRF Protection**: Required for state-changing forms; invalid tokens rejected.
- **SEO Compliance**: All pages generate Schema.org markup (e.g., `generateBreadcrumbSchema`); no localization nuances noted (English-only).

## Related Resources

- [project-overview.md](./project-overview.md)
